(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[392,794],{508:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(1847).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},2529:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(1847).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},3011:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useMergedRef",{enumerable:!0,get:function(){return a}});let s=r(2115);function a(e,t){let r=(0,s.useRef)(null),a=(0,s.useRef)(null);return(0,s.useCallback)(s=>{if(null===s){let e=r.current;e&&(r.current=null,e());let t=a.current;t&&(a.current=null,t())}else e&&(r.current=i(e,s)),t&&(a.current=i(t,s))},[e,t])}function i(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let r=e(t);return"function"==typeof r?r:()=>e(null)}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},3101:(e,t,r)=>{"use strict";r.d(t,{F:()=>n});var s=r(2821);let a=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,i=s.$,n=(e,t)=>r=>{var s;if((null==t?void 0:t.variants)==null)return i(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:n,defaultVariants:l}=t,o=Object.keys(n).map(e=>{let t=null==r?void 0:r[e],s=null==l?void 0:l[e];if(null===t)return null;let i=a(t)||a(s);return n[e][i]}),d=r&&Object.entries(r).reduce((e,t)=>{let[r,s]=t;return void 0===s||(e[r]=s),e},{});return i(e,o,null==t||null==(s=t.compoundVariants)?void 0:s.reduce((e,t)=>{let{class:r,className:s,...a}=t;return Object.entries(a).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...l,...d}[t]):({...l,...d})[t]===r})?[...e,r,s]:e},[]),null==r?void 0:r.class,null==r?void 0:r.className)}},3213:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var s=r(5155),a=r(2115),i=r(6948),n=r(8332),l=r(4600),o=r(5392),d=r(2529),c=r(508),u=r(5370),m=r(4652),f=r.n(m),h=r(5299);let p=(0,r(1847).A)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);function y(e){let{onStatusChange:t}=e,[r,l]=(0,a.useState)([]),[c,m]=(0,a.useState)("list"),[y,x]=(0,a.useState)(""),[g,v]=(0,a.useState)(""),[b,w]=(0,a.useState)(""),[j,N]=(0,a.useState)(""),[C,S]=(0,a.useState)(""),[A,k]=(0,a.useState)(!0),[P,F]=(0,a.useState)(!1),_=async()=>{try{let e=await (0,o.createSPASassClient)(),{data:t,error:r}=await e.getSupabaseClient().auth.mfa.listFactors();if(r)throw r;l(t.all||[]),k(!1)}catch(e){console.error("Error fetching MFA factors:",e),S(e instanceof Error?e.message:"Failed to fetch MFA status"),k(!1)}};(0,a.useEffect)(()=>{_()},[]);let E=async()=>{if(!j.trim())return void S("Please provide a name for this authentication method");S(""),F(!0);try{let e=await (0,o.createSPASassClient)(),t={factorType:"totp",friendlyName:j.trim()},{data:r,error:s}=await e.getSupabaseClient().auth.mfa.enroll(t);if(s)throw s;x(r.id),v(r.totp.qr_code),m("enroll")}catch(e){S(e instanceof Error?e.message:"Failed to start MFA enrollment"),m("name")}finally{F(!1)}},R=async()=>{S(""),F(!0);try{let e=(await (0,o.createSPASassClient)()).getSupabaseClient(),r=await e.auth.mfa.challenge({factorId:y});if(r.error)throw r.error;let s=await e.auth.mfa.verify({factorId:y,challengeId:r.data.id,code:b});if(s.error)throw s.error;await _(),M(),null==t||t()}catch(e){S(e instanceof Error?e.message:"Failed to verify MFA code")}finally{F(!1)}},T=async e=>{S(""),F(!0);try{let r=await (0,o.createSPASassClient)(),{error:s}=await r.getSupabaseClient().auth.mfa.unenroll({factorId:e});if(s)throw s;await _(),null==t||t()}catch(e){S(e instanceof Error?e.message:"Failed to unenroll MFA factor")}finally{F(!1)}},M=()=>{m("list"),x(""),v(""),w(""),N(""),S("")};return A?(0,s.jsx)(i.Zp,{children:(0,s.jsx)(i.Wu,{className:"flex justify-center items-center p-6",children:(0,s.jsx)(h.A,{className:"h-6 w-6 animate-spin"})})}):(0,s.jsxs)(i.Zp,{children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsxs)(i.ZB,{className:"flex items-center gap-2",children:[(0,s.jsx)(u.A,{className:"h-5 w-5"}),"Two-Factor Authentication (2FA)"]}),(0,s.jsx)(i.BT,{children:"Add an additional layer of security to your account"})]}),(0,s.jsxs)(i.Wu,{className:"space-y-4",children:[C&&(0,s.jsx)(n.Fc,{variant:"destructive",children:(0,s.jsx)(n.TN,{children:C})}),r.length>0&&"list"===c&&(0,s.jsx)("div",{className:"space-y-4",children:r.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:["verified"===e.status?(0,s.jsx)(d.A,{className:"h-5 w-5 text-green-500"}):(0,s.jsx)(p,{className:"h-5 w-5 text-red-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:e.friendly_name||"Authenticator App"}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Added on ",new Date(e.created_at).toLocaleDateString()]})]})]}),(0,s.jsx)("button",{onClick:()=>T(e.id),disabled:P,className:"px-3 py-1 text-sm text-red-600 hover:text-red-700 disabled:opacity-50",children:"Remove"})]},e.id))}),"name"===c&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{htmlFor:"friendly-name",className:"block text-sm font-medium text-gray-700",children:"Device Name"}),(0,s.jsx)("input",{id:"friendly-name",type:"text",value:j,onChange:e=>N(e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm",placeholder:"e.g., Work Phone, Personal iPhone",autoFocus:!0}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Give this authentication method a name to help you identify it later"})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{onClick:M,disabled:P,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50",children:"Cancel"}),(0,s.jsx)("button",{onClick:E,disabled:P||!j.trim(),className:"flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50",children:P?"Processing...":"Continue"})]})]}),"enroll"===c&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"flex justify-center",children:g&&(0,s.jsx)(f(),{src:g,alt:"QR Code",width:192,height:192,className:"w-48 h-48 border rounded-lg p-2",unoptimized:!0})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{htmlFor:"verify-code",className:"block text-sm font-medium text-gray-700",children:"Verification Code"}),(0,s.jsx)("input",{id:"verify-code",type:"text",value:b,onChange:e=>w(e.target.value.trim()),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm",placeholder:"Enter code from your authenticator app"})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{onClick:M,disabled:P,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50",children:"Cancel"}),(0,s.jsx)("button",{onClick:R,disabled:P||0===b.length,className:"flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50",children:P?"Verifying...":"Verify"})]})]}),"list"===c&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:0===r.length?"Protect your account with two-factor authentication. When enabled, you'll need to enter a code from your authenticator app in addition to your password when signing in.":"You can add additional authentication methods or remove existing ones."}),(0,s.jsx)("button",{onClick:()=>m("name"),disabled:P,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50",children:P?"Processing...":"Add New Authentication Method"})]})]})]})}function x(){let{user:e}=(0,l.P)(),[t,r]=(0,a.useState)(""),[m,f]=(0,a.useState)(""),[h,p]=(0,a.useState)(!1),[x,g]=(0,a.useState)(""),[v,b]=(0,a.useState)(""),w=async e=>{if(e.preventDefault(),t!==m)return void g("New passwords don't match");p(!0),g(""),b("");try{let e=(await (0,o.X)()).getSupabaseClient(),{error:s}=await e.auth.updateUser({password:t});if(s)throw s;b("Password updated successfully"),r(""),f("")}catch(e){e instanceof Error?(console.error("Error updating password:",e),g(e.message)):(console.error("Error updating password:",e),g("Failed to update password"))}finally{p(!1)}};return(0,s.jsxs)("div",{className:"space-y-6 p-6",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"User Settings"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Manage your account settings and preferences"})]}),x&&(0,s.jsx)(n.Fc,{variant:"destructive",children:(0,s.jsx)(n.TN,{children:x})}),v&&(0,s.jsxs)(n.Fc,{children:[(0,s.jsx)(d.A,{className:"h-4 w-4"}),(0,s.jsx)(n.TN,{children:v})]}),(0,s.jsx)("div",{className:"grid gap-6",children:(0,s.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,s.jsxs)(i.Zp,{children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsxs)(i.ZB,{className:"flex items-center gap-2",children:[(0,s.jsx)(c.A,{className:"h-5 w-5"}),"User Details"]}),(0,s.jsx)(i.BT,{children:"Your account information"})]}),(0,s.jsxs)(i.Wu,{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"User ID"}),(0,s.jsx)("p",{className:"mt-1 text-sm",children:null==e?void 0:e.id})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Email"}),(0,s.jsx)("p",{className:"mt-1 text-sm",children:null==e?void 0:e.email})]})]})]}),(0,s.jsxs)(i.Zp,{children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsxs)(i.ZB,{className:"flex items-center gap-2",children:[(0,s.jsx)(u.A,{className:"h-5 w-5"}),"Change Password"]}),(0,s.jsx)(i.BT,{children:"Update your account password"})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"new-password",className:"block text-sm font-medium text-gray-700",children:"New Password"}),(0,s.jsx)("input",{type:"password",id:"new-password",value:t,onChange:e=>r(e.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-primary-500 focus:outline-none focus:ring-primary-500 text-sm",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"confirm-password",className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),(0,s.jsx)("input",{type:"password",id:"confirm-password",value:m,onChange:e=>f(e.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-primary-500 focus:outline-none focus:ring-primary-500 text-sm",required:!0})]}),(0,s.jsx)("button",{type:"submit",disabled:h,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50",children:h?"Updating...":"Update Password"})]})})]}),(0,s.jsx)(y,{onStatusChange:()=>{b("Two-factor authentication settings updated successfully")}})]})})]})}},3841:(e,t,r)=>{Promise.resolve().then(r.bind(r,3213))},4269:(e,t,r)=>{"use strict";r.d(t,{cn:()=>i});var s=r(2821),a=r(5889);function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}},4600:(e,t,r)=>{"use strict";r.d(t,{GlobalProvider:()=>l,P:()=>o});var s=r(5155),a=r(2115),i=r(5392);let n=(0,a.createContext)(void 0);function l(e){let{children:t}=e,[r,l]=(0,a.useState)(!0),[o,d]=(0,a.useState)(null);return(0,a.useEffect)(()=>{!async function(){try{let e=(await (0,i.X)()).getSupabaseClient(),{data:{user:t}}=await e.auth.getUser();if(t)d({email:t.email,id:t.id,registered_at:new Date(t.created_at)});else throw Error("User not found")}catch(e){console.error("Error loading data:",e)}finally{l(!1)}}()},[]),(0,s.jsx)(n.Provider,{value:{loading:r,user:o},children:t})}let o=()=>{let e=(0,a.useContext)(n);if(void 0===e)throw Error("useGlobal must be used within a GlobalProvider");return e}},4652:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return o},getImageProps:function(){return l}});let s=r(8140),a=r(5040),i=r(1356),n=s._(r(1124));function l(e){let{props:t}=(0,a.getImgProps)(e,{defaultLoader:n.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image/",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let o=i.Image},5299:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(1847).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},5370:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(1847).A)("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]])},5392:(e,t,r)=>{"use strict";r.d(t,{q:()=>n,createSPASassClient:()=>l,X:()=>o});var s=r(6620),a=function(e){return e.SERVER="server",e.SPA="spa",e}({});class i{async loginEmail(e,t){return this.client.auth.signInWithPassword({email:e,password:t})}async registerEmail(e,t){return this.client.auth.signUp({email:e,password:t})}async exchangeCodeForSession(e){return this.client.auth.exchangeCodeForSession(e)}async resendVerificationEmail(e){return this.client.auth.resend({email:e,type:"signup"})}async logout(){let{error:e}=await this.client.auth.signOut({scope:"local"});if(e)throw e;"spa"===this.clientType&&(window.location.href="/auth/login")}async uploadFile(e,t,r){return t=e+"/"+(t=t.replace(/[^0-9a-zA-Z!\-_.*'()]/g,"_")),this.client.storage.from("files").upload(t,r)}async getFiles(e){return this.client.storage.from("files").list(e)}async deleteFile(e,t){return t=e+"/"+t,this.client.storage.from("files").remove([t])}async shareFile(e,t,r){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return t=e+"/"+t,this.client.storage.from("files").createSignedUrl(t,r,{download:s})}async getMyTodoList(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"created_at",s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=this.client.from("todo_list").select("*").range(e*t-t,e*t-1).order(r);return null!==s&&(a=a.eq("done",s)),a}async createTask(e){return this.client.from("todo_list").insert(e)}async removeTask(e){return this.client.from("todo_list").delete().eq("id",e)}async updateAsDone(e){return this.client.from("todo_list").update({done:!0}).eq("id",e)}getSupabaseClient(){return this.client}constructor(e,t){this.client=e,this.clientType=t}}function n(){return(0,s.createBrowserClient)("https://xcopajcpimrsqcqhydug.supabase.co","sb_publishable_pGN0njb-9XysERIUFiYtPg_NbAQuZGT")}async function l(){return new i(n(),a.SPA)}async function o(){let e=n(),t=await e.auth.getSession();return t.data&&t.data.session||(window.location.href="/auth/login"),new i(e,a.SPA)}},6948:(e,t,r)=>{"use strict";r.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>o,Zp:()=>n,aR:()=>l});var s=r(5155),a=r(2115),i=r(4269);let n=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});n.displayName="Card";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",r),...a})});l.displayName="CardHeader";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});o.displayName="CardTitle";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",r),...a})});d.displayName="CardDescription";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",r),...a})});c.displayName="CardContent",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",r),...a})}).displayName="CardFooter"},8332:(e,t,r)=>{"use strict";r.d(t,{Fc:()=>o,TN:()=>d});var s=r(5155),a=r(2115),i=r(3101),n=r(4269);let l=(0,i.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),o=a.forwardRef((e,t)=>{let{className:r,variant:a,...i}=e;return(0,s.jsx)("div",{ref:t,role:"alert",className:(0,n.cn)(l({variant:a}),r),...i})});o.displayName="Alert",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("h5",{ref:t,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",r),...a})}).displayName="AlertTitle";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",r),...a})});d.displayName="AlertDescription"}},e=>{e.O(0,[620,779,356,441,255,358],()=>e(e.s=3841)),_N_E=e.O()}]);