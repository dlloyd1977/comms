(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[253],{63:(e,t,a)=>{"use strict";var r=a(7260);a.o(r,"useParams")&&a.d(t,{useParams:function(){return r.useParams}}),a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},1847:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var r=a(2115);let s=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,r.forwardRef)((e,t)=>{let{color:a="currentColor",size:l=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:c="",children:d,iconNode:u,...m}=e;return(0,r.createElement)("svg",{ref:t,...n,width:l,height:l,stroke:a,strokeWidth:o?24*Number(i)/Number(l):i,className:s("lucide",c),...m},[...u.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(d)?d:[d]])}),i=(e,t)=>{let a=(0,r.forwardRef)((a,n)=>{let{className:i,...o}=a;return(0,r.createElement)(l,{ref:n,iconNode:t,className:s("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),i),...o})});return a.displayName="".concat(e),a}},4600:(e,t,a)=>{"use strict";a.d(t,{GlobalProvider:()=>i,P:()=>o});var r=a(5155),s=a(2115),n=a(5392);let l=(0,s.createContext)(void 0);function i(e){let{children:t}=e,[a,i]=(0,s.useState)(!0),[o,c]=(0,s.useState)(null);return(0,s.useEffect)(()=>{!async function(){try{let i=(await (0,n.Xy)()).getSupabaseClient(),{data:{user:o}}=await i.auth.getUser();if(o){var e,t,a,r,s,l;let n=o.email,d=((null==(e=o.user_metadata)?void 0:e.nickname)||"").trim()||((null==(t=o.user_metadata)?void 0:t.first_name)||"").trim()||n,u=null!=(s=null==(a=o.user_metadata)?void 0:a.first_name)?s:null,m=null!=(l=null==(r=o.user_metadata)?void 0:r.nickname)?l:null;try{let{data:e}=await i.from("active_members").select("nickname, first_name").eq("email",n).maybeSingle();(null==e?void 0:e.nickname)&&(m=e.nickname),(null==e?void 0:e.first_name)&&(u=e.first_name),d=(m||"").trim()||(u||"").trim()||n}catch(e){console.warn("Profile lookup failed:",e)}c({email:n,id:o.id,registered_at:new Date(o.created_at),first_name:u,nickname:m,display_name:d})}else throw Error("User not found")}catch(e){console.error("Error loading data:",e)}finally{i(!1)}}()},[]),(0,r.jsx)(l.Provider,{value:{loading:a,user:o},children:t})}let o=()=>{let e=(0,s.useContext)(l);if(void 0===e)throw Error("useGlobal must be used within a GlobalProvider");return e}},4891:(e,t,a)=>{"use strict";a.d(t,{default:()=>p});var r=a(5155),s=a(2115),n=a(2619),l=a.n(n),i=a(63),o=a(1847);let c=(0,o.A)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);var d=a(5229);let u=(0,o.A)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),m=(0,o.A)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);var h=a(5370);let y=(0,o.A)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);var g=a(4600),x=a(5392);function p(e){let{children:t}=e,[a,n]=(0,s.useState)(!1),[o,p]=(0,s.useState)(!1),f=(0,i.usePathname)(),v=(0,i.useRouter)(),{user:w}=(0,g.P)(),b=async()=>{try{let e=await (0,x.q)();await e.logout()}catch(e){console.error("Error logging out:",e)}},k=async()=>{v.push("/kybalion/")},j=()=>n(!a);return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[a&&(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 z-20 lg:hidden",onClick:j}),(0,r.jsxs)("div",{className:"fixed inset-y-0 left-0 w-64 bg-white shadow-lg transform transition-transform duration-200 ease-in-out z-30 \n                ".concat(a?"translate-x-0":"-translate-x-full"," lg:translate-x-0"),children:[(0,r.jsxs)("div",{className:"h-16 flex items-center justify-between px-4 border-b",children:[(0,r.jsx)("span",{className:"text-xl font-semibold text-primary-600",children:"Kybalion"}),(0,r.jsx)("button",{onClick:j,className:"lg:hidden text-gray-500 hover:text-gray-700",children:(0,r.jsx)(d.A,{className:"h-6 w-6"})})]}),(0,r.jsx)("nav",{className:"mt-4 px-2 space-y-1",children:[{name:"Kybalion Home",href:"/kybalion/",icon:c}].map(e=>{let t=f===e.href;return(0,r.jsxs)(l(),{href:e.href,className:"group flex items-center px-2 py-2 text-sm font-medium rounded-md ".concat(t?"bg-primary-50 text-primary-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:[(0,r.jsx)(e.icon,{className:"mr-3 h-5 w-5 ".concat(t?"text-primary-500":"text-gray-400 group-hover:text-gray-500")}),e.name]},e.name)})})]}),(0,r.jsxs)("div",{className:"lg:pl-64",children:[(0,r.jsxs)("div",{className:"sticky top-0 z-10 flex items-center justify-between h-16 bg-white shadow-sm px-4",children:[(0,r.jsx)("button",{onClick:j,className:"lg:hidden text-gray-500 hover:text-gray-700",children:(0,r.jsx)(u,{className:"h-6 w-6"})}),(0,r.jsxs)("div",{className:"relative ml-auto",children:[(null==w?void 0:w.display_name)||(null==w?void 0:w.email)?(0,r.jsxs)("span",{className:"mr-4 text-sm font-semibold text-gray-700",children:["Current User: ",(null==w?void 0:w.display_name)||(null==w?void 0:w.email)]}):null,(0,r.jsxs)("button",{onClick:()=>p(!o),className:"flex items-center space-x-2 text-sm text-gray-700 hover:text-gray-900",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-primary-100 flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-primary-700 font-medium",children:w?(e=>{let t=e.includes("@")?e.split("@")[0]:e,a=t.trim().split(/[._\s-]+/).filter(Boolean);return a.length>1?(a[0][0]+a[1][0]).toUpperCase():t.slice(0,2).toUpperCase()})(w.display_name||w.email):"??"})}),(0,r.jsx)("span",{children:(null==w?void 0:w.display_name)||(null==w?void 0:w.email)||"Loading..."}),(0,r.jsx)(m,{className:"h-4 w-4"})]}),o&&(0,r.jsxs)("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-md shadow-lg border",children:[(0,r.jsxs)("div",{className:"p-2 border-b border-gray-100",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Current User"}),(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:(null==w?void 0:w.display_name)||(null==w?void 0:w.email)}),(null==w?void 0:w.email)&&(null==w?void 0:w.display_name)?(0,r.jsx)("p",{className:"text-xs text-gray-500 truncate",children:w.email}):null]}),(0,r.jsxs)("div",{className:"py-1",children:[(0,r.jsxs)("button",{onClick:()=>{p(!1),k()},className:"w-full flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[(0,r.jsx)(h.A,{className:"mr-3 h-4 w-4 text-gray-400"}),"Change Password"]}),(0,r.jsxs)("button",{onClick:()=>{b(),p(!1)},className:"w-full flex items-center px-4 py-2 text-sm text-red-600 hover:bg-red-50",children:[(0,r.jsx)(y,{className:"mr-3 h-4 w-4 text-red-400"}),"Sign Out"]})]})]})]})]}),(0,r.jsx)("main",{className:"p-4",children:t})]})]})}},5229:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1847).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},5370:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1847).A)("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]])},5392:(e,t,a)=>{"use strict";a.d(t,{q7:()=>l,q:()=>i,Xy:()=>o});var r=a(6620),s=function(e){return e.SERVER="server",e.SPA="spa",e}({});class n{async loginEmail(e,t){return this.client.auth.signInWithPassword({email:e,password:t})}async registerEmail(e,t){return this.client.auth.signUp({email:e,password:t})}async exchangeCodeForSession(e){return this.client.auth.exchangeCodeForSession(e)}async resendVerificationEmail(e){return this.client.auth.resend({email:e,type:"signup"})}async logout(){try{let e=new URL("https://xcopajcpimrsqcqhydug.supabase.co").host.split(".")[0],t="sb-".concat(e,"-");for(let e=localStorage.length-1;e>=0;e--){let a=localStorage.key(e);(null==a?void 0:a.startsWith(t))&&localStorage.removeItem(a)}for(let e=sessionStorage.length-1;e>=0;e--){let a=sessionStorage.key(e);(null==a?void 0:a.startsWith(t))&&sessionStorage.removeItem(a)}}catch(e){}let{error:e}=await this.client.auth.signOut({scope:"local"});if(e)throw e;"spa"===this.clientType&&(window.location.href="/auth/login")}async uploadFile(e,t,a){return t=e+"/"+(t=t.replace(/[^0-9a-zA-Z!\-_.*'()]/g,"_")),this.client.storage.from("files").upload(t,a)}async getFiles(e){return this.client.storage.from("files").list(e)}async deleteFile(e,t){return t=e+"/"+t,this.client.storage.from("files").remove([t])}async shareFile(e,t,a){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return t=e+"/"+t,this.client.storage.from("files").createSignedUrl(t,a,{download:r})}async getMyTodoList(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"created_at",r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=this.client.from("todo_list").select("*").range(e*t-t,e*t-1).order(a);return null!==r&&(s=s.eq("done",r)),s}async createTask(e){return this.client.from("todo_list").insert(e)}async removeTask(e){return this.client.from("todo_list").delete().eq("id",e)}async updateAsDone(e){return this.client.from("todo_list").update({done:!0}).eq("id",e)}getSupabaseClient(){return this.client}constructor(e,t){this.client=e,this.clientType=t}}function l(){return(0,r.createBrowserClient)("https://xcopajcpimrsqcqhydug.supabase.co","sb_publishable_pGN0njb-9XysERIUFiYtPg_NbAQuZGT")}async function i(){return new n(l(),s.SPA)}async function o(){let e=l(),t=await e.auth.getSession();return t.data&&t.data.session||(window.location.href="/auth/login"),new n(e,s.SPA)}},5420:(e,t,a)=>{Promise.resolve().then(a.bind(a,4891)),Promise.resolve().then(a.bind(a,4600))}},e=>{e.O(0,[619,620,441,255,358],()=>e(e.s=5420)),_N_E=e.O()}]);