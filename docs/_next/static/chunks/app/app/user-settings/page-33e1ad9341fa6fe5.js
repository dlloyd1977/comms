(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[794],{3841:(e,t,s)=>{Promise.resolve().then(s.bind(s,9675))},4269:(e,t,s)=>{"use strict";s.d(t,{cn:()=>i});var r=s(2821),a=s(5889);function i(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.QP)((0,r.$)(t))}},4600:(e,t,s)=>{"use strict";s.d(t,{GlobalProvider:()=>l,P:()=>o});var r=s(5155),a=s(2115),i=s(5392);let n=(0,a.createContext)(void 0);function l(e){let{children:t}=e,[s,l]=(0,a.useState)(!0),[o,d]=(0,a.useState)(null);return(0,a.useEffect)(()=>{!async function(){try{let e=(await (0,i.Xy)()).getSupabaseClient(),{data:{user:t}}=await e.auth.getUser();if(t)d({email:t.email,id:t.id,registered_at:new Date(t.created_at)});else throw Error("User not found")}catch(e){console.error("Error loading data:",e)}finally{l(!1)}}()},[]),(0,r.jsx)(n.Provider,{value:{loading:s,user:o},children:t})}let o=()=>{let e=(0,a.useContext)(n);if(void 0===e)throw Error("useGlobal must be used within a GlobalProvider");return e}},5392:(e,t,s)=>{"use strict";s.d(t,{q7:()=>n,q:()=>l,Xy:()=>o});var r=s(6620),a=function(e){return e.SERVER="server",e.SPA="spa",e}({});class i{async loginEmail(e,t){return this.client.auth.signInWithPassword({email:e,password:t})}async registerEmail(e,t){return this.client.auth.signUp({email:e,password:t})}async exchangeCodeForSession(e){return this.client.auth.exchangeCodeForSession(e)}async resendVerificationEmail(e){return this.client.auth.resend({email:e,type:"signup"})}async logout(){let{error:e}=await this.client.auth.signOut({scope:"local"});if(e)throw e;"spa"===this.clientType&&(window.location.href="/auth/login")}async uploadFile(e,t,s){return t=e+"/"+(t=t.replace(/[^0-9a-zA-Z!\-_.*'()]/g,"_")),this.client.storage.from("files").upload(t,s)}async getFiles(e){return this.client.storage.from("files").list(e)}async deleteFile(e,t){return t=e+"/"+t,this.client.storage.from("files").remove([t])}async shareFile(e,t,s){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return t=e+"/"+t,this.client.storage.from("files").createSignedUrl(t,s,{download:r})}async getMyTodoList(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"created_at",r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=this.client.from("todo_list").select("*").range(e*t-t,e*t-1).order(s);return null!==r&&(a=a.eq("done",r)),a}async createTask(e){return this.client.from("todo_list").insert(e)}async removeTask(e){return this.client.from("todo_list").delete().eq("id",e)}async updateAsDone(e){return this.client.from("todo_list").update({done:!0}).eq("id",e)}getSupabaseClient(){return this.client}constructor(e,t){this.client=e,this.clientType=t}}function n(){return(0,r.createBrowserClient)("https://xcopajcpimrsqcqhydug.supabase.co","sb_publishable_pGN0njb-9XysERIUFiYtPg_NbAQuZGT")}async function l(){return new i(n(),a.SPA)}async function o(){let e=n(),t=await e.auth.getSession();return t.data&&t.data.session||(window.location.href="/auth/login"),new i(e,a.SPA)}},6948:(e,t,s)=>{"use strict";s.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>o,Zp:()=>n,aR:()=>l});var r=s(5155),a=s(2115),i=s(4269);let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a})});n.displayName="Card";let l=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",s),...a})});l.displayName="CardHeader";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",s),...a})});o.displayName="CardTitle";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",s),...a})});d.displayName="CardDescription";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",s),...a})});c.displayName="CardContent",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",s),...a})}).displayName="CardFooter"},8332:(e,t,s)=>{"use strict";s.d(t,{Fc:()=>o,TN:()=>d});var r=s(5155),a=s(2115),i=s(3101),n=s(4269);let l=(0,i.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),o=a.forwardRef((e,t)=>{let{className:s,variant:a,...i}=e;return(0,r.jsx)("div",{ref:t,role:"alert",className:(0,n.cn)(l({variant:a}),s),...i})});o.displayName="Alert",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("h5",{ref:t,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",s),...a})}).displayName="AlertTitle";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",s),...a})});d.displayName="AlertDescription"},9675:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var r=s(5155),a=s(2115),i=s(6948),n=s(8332),l=s(4600),o=s(5392),d=s(2529),c=s(508),u=s(5370),m=s(5239),h=s(5299),f=s(8874);function p(e){let{onStatusChange:t}=e,[s,l]=(0,a.useState)([]),[c,p]=(0,a.useState)("list"),[x,g]=(0,a.useState)(""),[y,w]=(0,a.useState)(""),[b,v]=(0,a.useState)(""),[j,N]=(0,a.useState)(""),[C,S]=(0,a.useState)(""),[F,A]=(0,a.useState)(!0),[k,E]=(0,a.useState)(!1),P=async()=>{try{let e=await (0,o.q)(),{data:t,error:s}=await e.getSupabaseClient().auth.mfa.listFactors();if(s)throw s;l(t.all||[]),A(!1)}catch(e){console.error("Error fetching MFA factors:",e),S(e instanceof Error?e.message:"Failed to fetch MFA status"),A(!1)}};(0,a.useEffect)(()=>{P()},[]);let _=async()=>{if(!j.trim())return void S("Please provide a name for this authentication method");S(""),E(!0);try{let e=await (0,o.q)(),t={factorType:"totp",friendlyName:j.trim()},{data:s,error:r}=await e.getSupabaseClient().auth.mfa.enroll(t);if(r)throw r;g(s.id),w(s.totp.qr_code),p("enroll")}catch(e){S(e instanceof Error?e.message:"Failed to start MFA enrollment"),p("name")}finally{E(!1)}},T=async()=>{S(""),E(!0);try{let e=(await (0,o.q)()).getSupabaseClient(),s=await e.auth.mfa.challenge({factorId:x});if(s.error)throw s.error;let r=await e.auth.mfa.verify({factorId:x,challengeId:s.data.id,code:b});if(r.error)throw r.error;await P(),q(),null==t||t()}catch(e){S(e instanceof Error?e.message:"Failed to verify MFA code")}finally{E(!1)}},R=async e=>{S(""),E(!0);try{let s=await (0,o.q)(),{error:r}=await s.getSupabaseClient().auth.mfa.unenroll({factorId:e});if(r)throw r;await P(),null==t||t()}catch(e){S(e instanceof Error?e.message:"Failed to unenroll MFA factor")}finally{E(!1)}},q=()=>{p("list"),g(""),w(""),v(""),N(""),S("")};return F?(0,r.jsx)(i.Zp,{children:(0,r.jsx)(i.Wu,{className:"flex justify-center items-center p-6",children:(0,r.jsx)(h.A,{className:"h-6 w-6 animate-spin"})})}):(0,r.jsxs)(i.Zp,{children:[(0,r.jsxs)(i.aR,{children:[(0,r.jsxs)(i.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(u.A,{className:"h-5 w-5"}),"Two-Factor Authentication (2FA)"]}),(0,r.jsx)(i.BT,{children:"Add an additional layer of security to your account"})]}),(0,r.jsxs)(i.Wu,{className:"space-y-4",children:[C&&(0,r.jsx)(n.Fc,{variant:"destructive",children:(0,r.jsx)(n.TN,{children:C})}),s.length>0&&"list"===c&&(0,r.jsx)("div",{className:"space-y-4",children:s.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:["verified"===e.status?(0,r.jsx)(d.A,{className:"h-5 w-5 text-green-500"}):(0,r.jsx)(f.A,{className:"h-5 w-5 text-red-500"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:e.friendly_name||"Authenticator App"}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:["Added on ",new Date(e.created_at).toLocaleDateString()]})]})]}),(0,r.jsx)("button",{onClick:()=>R(e.id),disabled:k,className:"px-3 py-1 text-sm text-red-600 hover:text-red-700 disabled:opacity-50",children:"Remove"})]},e.id))}),"name"===c&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{htmlFor:"friendly-name",className:"block text-sm font-medium text-gray-700",children:"Device Name"}),(0,r.jsx)("input",{id:"friendly-name",type:"text",value:j,onChange:e=>N(e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm",placeholder:"e.g., Work Phone, Personal iPhone",autoFocus:!0}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Give this authentication method a name to help you identify it later"})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{onClick:q,disabled:k,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50",children:"Cancel"}),(0,r.jsx)("button",{onClick:_,disabled:k||!j.trim(),className:"flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50",children:k?"Processing...":"Continue"})]})]}),"enroll"===c&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"flex justify-center",children:y&&(0,r.jsx)(m.default,{src:y,alt:"QR Code",width:192,height:192,className:"w-48 h-48 border rounded-lg p-2",unoptimized:!0})}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{htmlFor:"verify-code",className:"block text-sm font-medium text-gray-700",children:"Verification Code"}),(0,r.jsx)("input",{id:"verify-code",type:"text",value:b,onChange:e=>v(e.target.value.trim()),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm",placeholder:"Enter code from your authenticator app"})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{onClick:q,disabled:k,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50",children:"Cancel"}),(0,r.jsx)("button",{onClick:T,disabled:k||0===b.length,className:"flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50",children:k?"Verifying...":"Verify"})]})]}),"list"===c&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:0===s.length?"Protect your account with two-factor authentication. When enabled, you'll need to enter a code from your authenticator app in addition to your password when signing in.":"You can add additional authentication methods or remove existing ones."}),(0,r.jsx)("button",{onClick:()=>p("name"),disabled:k,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50",children:k?"Processing...":"Add New Authentication Method"})]})]})]})}function x(){let{user:e}=(0,l.P)(),[t,s]=(0,a.useState)(""),[m,h]=(0,a.useState)(""),[f,x]=(0,a.useState)(!1),[g,y]=(0,a.useState)(""),[w,b]=(0,a.useState)(""),v=async e=>{if(e.preventDefault(),t!==m)return void y("New passwords don't match");x(!0),y(""),b("");try{let e=(await (0,o.Xy)()).getSupabaseClient(),{error:r}=await e.auth.updateUser({password:t});if(r)throw r;b("Password updated successfully"),s(""),h("")}catch(e){e instanceof Error?(console.error("Error updating password:",e),y(e.message)):(console.error("Error updating password:",e),y("Failed to update password"))}finally{x(!1)}};return(0,r.jsxs)("div",{className:"space-y-6 p-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"User Settings"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Manage your account settings and preferences"})]}),g&&(0,r.jsx)(n.Fc,{variant:"destructive",children:(0,r.jsx)(n.TN,{children:g})}),w&&(0,r.jsxs)(n.Fc,{children:[(0,r.jsx)(d.A,{className:"h-4 w-4"}),(0,r.jsx)(n.TN,{children:w})]}),(0,r.jsx)("div",{className:"grid gap-6",children:(0,r.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,r.jsxs)(i.Zp,{children:[(0,r.jsxs)(i.aR,{children:[(0,r.jsxs)(i.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(c.A,{className:"h-5 w-5"}),"User Details"]}),(0,r.jsx)(i.BT,{children:"Your account information"})]}),(0,r.jsxs)(i.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"User ID"}),(0,r.jsx)("p",{className:"mt-1 text-sm",children:null==e?void 0:e.id})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Email"}),(0,r.jsx)("p",{className:"mt-1 text-sm",children:null==e?void 0:e.email})]})]})]}),(0,r.jsxs)(i.Zp,{children:[(0,r.jsxs)(i.aR,{children:[(0,r.jsxs)(i.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(u.A,{className:"h-5 w-5"}),"Change Password"]}),(0,r.jsx)(i.BT,{children:"Update your account password"})]}),(0,r.jsx)(i.Wu,{children:(0,r.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"new-password",className:"block text-sm font-medium text-gray-700",children:"New Password"}),(0,r.jsx)("input",{type:"password",id:"new-password",value:t,onChange:e=>s(e.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-primary-500 focus:outline-none focus:ring-primary-500 text-sm",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"confirm-password",className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),(0,r.jsx)("input",{type:"password",id:"confirm-password",value:m,onChange:e=>h(e.target.value),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-primary-500 focus:outline-none focus:ring-primary-500 text-sm",required:!0})]}),(0,r.jsx)("button",{type:"submit",disabled:f,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50",children:f?"Updating...":"Update Password"})]})})]}),(0,r.jsx)(p,{onStatusChange:()=>{b("Two-factor authentication settings updated successfully")}})]})})]})}}},e=>{e.O(0,[620,779,278,441,255,358],()=>e(e.s=3841)),_N_E=e.O()}]);